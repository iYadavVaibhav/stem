


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data Engineering, Data Science, Business Analytics, Data Visualization, Business Intelligence">
      
      
        <meta name="author" content="Vaibhav Yadav - Data Engineer, Scientist and Analyst">
      
      
        <link rel="canonical" href="https://iYadavVaibhav.github.io/stem/2-Data-Engineering/apache-spark/">
      
      
        <link rel="prev" href="../apache-kafka/">
      
      
        <link rel="next" href="../big-data/">
      
      
      <link rel="icon" href="../../assets/images/apple-touch-icon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Apache Spark - Vaibhav Yadav's Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apache-spark" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vaibhav Yadav&#39;s Wiki" class="md-header__button md-logo" aria-label="Vaibhav Yadav's Wiki" data-md-component="logo">
      
  <img src="../../assets/images/apple-touch-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vaibhav Yadav's Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apache Spark
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/iYadavVaibhav/stem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    iyadavvaibhav/stem
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vaibhav Yadav&#39;s Wiki" class="md-nav__button md-logo" aria-label="Vaibhav Yadav's Wiki" data-md-component="logo">
      
  <img src="../../assets/images/apple-touch-icon.png" alt="logo">

    </a>
    Vaibhav Yadav's Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/iYadavVaibhav/stem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    iyadavvaibhav/stem
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home iYV
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0 Information Technology
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            0 Information Technology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/aws-amazon-web-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amazon Web Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/bokeh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bokeh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/bootstrap-ui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap UI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dockerize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/flask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/flutter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flutter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/gen-ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Artificial Intelligence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/google-cloud-platform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google Cloud Platform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/htmx-flask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTMX and use with Flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/javascript-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JavaScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/material-mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Material for MkDocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/nativescript-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NativeScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/pelican/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pelican
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/plotly-dash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotly and Dash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/pwa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PWA with Flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/python-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/r-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R and R-Studio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/react-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React JS Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/text-editors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text Editors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/tools-frameworks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools and Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/virtual-box/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Box
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0-Information-Technology/web-server-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Server Config
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 Software Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            1 Software Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/cs-se-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSE Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/data-structures-algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Structures and Algorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/design-principle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Design Principles and Patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/devops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/domain-driven-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Driven Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and GitHub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/js-ecma6-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECMA 6+
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/linux-terminal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/networking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/oops-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OOPs in Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/regex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security, IAM, RBAC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/software-diagrams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Diagrams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/web-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Development
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 Data Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2 Data Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apache-airflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache Airflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apache-iceberg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache Iceberg Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apache-kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache Kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Apache Spark
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Apache Spark
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spark-architecture-and-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Architecture and Execution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      Parallelism
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Plan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-core" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Core
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Streaming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-sql-spark-analytics-with-spark-sql" class="md-nav__link">
    <span class="md-ellipsis">
      Spark SQL - Spark Analytics with Spark SQL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-ml-lib-machine-learning-with-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Spark ML Lib - Machine Learning with Spark
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-graphx" class="md-nav__link">
    <span class="md-ellipsis">
      Spark GraphX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing" class="md-nav__link">
    <span class="md-ellipsis">
      Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-installations" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Installations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#databricks" class="md-nav__link">
    <span class="md-ellipsis">
      Databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ll-apache-spark-essential-training-big-data-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      LL - Apache Spark Essential Training: Big Data Engineering
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../big-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Big Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Engineering Roadmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-frameworks-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Tools &amp; Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Operations in Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-science/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Science
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Solutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-warehousing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databases &amp; SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databricks Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../etl_pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ETL Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python-data-wrangling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Data Wrangling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tableau/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tableau
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3 Management & Strategy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            3 Management & Strategy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-Management-%26-Strategy/ajile-sprint-scrum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agile, Scrum and Sprints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-Management-%26-Strategy/project-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 Functional & Business
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            4 Functional & Business
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-Functional-%26-Business/banking-finance-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Banking and Finance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-Functional-%26-Business/business-analytics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Analytics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5 Personal Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            5 Personal Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Personal-Development/interview-career-growth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Career Growth Interview Mindset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Personal-Development/pd-courses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Personal Development Courses
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6 Math & Logic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            6 Math & Logic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6-Math-%26-Logic/logarithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logarithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6-Math-%26-Logic/probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    7 Other
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            7 Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Other/electronics-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electronics &amp; IoT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    8 Blog & Articles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            8 Blog & Articles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/fake-data-using-faker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Create fake data using Faker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/github-pages-jekyll/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jekyll on Github
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/hello-humans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello Humans
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/syntax-highlight-jekyll/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jekyll Syntax Highlight
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    9 Drafts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            9 Drafts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/dea-c01-u0-exam-course-intro-ps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS DEA-C01 Preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/dea-c01-u1-data-ingestion-and-transformation-ps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    U1 Data Ingestion and Transformation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/dea-c01-u2-data-store-management-ps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    U2 Data Store Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/dea-c01-u3-data-operations-and-support-ps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    U3 Data Operations and Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/dea-c01-u4-data-security-and-governance-ps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    U4 Data Security and Governance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/ll-py-design-patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python: Design Patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/ll-software-architecture-domain-driven-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Architecture: Domain-Driven Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/mblog-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App - mBlog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/mongodb-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mongo DB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/notepad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notepad
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spark-architecture-and-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Architecture and Execution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      Parallelism
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Plan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-core" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Core
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Streaming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-sql-spark-analytics-with-spark-sql" class="md-nav__link">
    <span class="md-ellipsis">
      Spark SQL - Spark Analytics with Spark SQL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-ml-lib-machine-learning-with-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Spark ML Lib - Machine Learning with Spark
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-graphx" class="md-nav__link">
    <span class="md-ellipsis">
      Spark GraphX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing" class="md-nav__link">
    <span class="md-ellipsis">
      Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-installations" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Installations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#databricks" class="md-nav__link">
    <span class="md-ellipsis">
      Databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ll-apache-spark-essential-training-big-data-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      LL - Apache Spark Essential Training: Big Data Engineering
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

    
                  

  
    <a href="https://github.com/iYadavVaibhav/stem/edit/master/docs/2-Data-Engineering/apache-spark.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/iYadavVaibhav/stem/raw/master/docs/2-Data-Engineering/apache-spark.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="apache-spark">Apache Spark</h1>
<p>No storing, only processing</p>
<ul>
<li><strong>Apache Spark</strong><ul>
<li>allows distributed parallel execution.</li>
<li>external data -&gt; loaded to -&gt; data frame -&gt; which is -&gt; RDD -&gt; runs on -&gt; different nodes within the cluster.</li>
<li>large-scale data processing as pandas.</li>
<li>InMemory to avoid disk-writes slowness  of map reduce</li>
<li>Data Structure is RDDs</li>
<li>Interactive analytics are faster, just like we do in Jupyter where next step is based on prev.</li>
<li>Transformations - <code>filter()</code> map groupByKey union - give RDD</li>
<li>Actions - count first collect reduce - give single result</li>
<li>PySpark - Python API for spark, RDD as DataFrame so makes similar to Pandas.</li>
</ul>
</li>
</ul>
<h2 id="spark-architecture-and-execution">Spark Architecture and Execution</h2>
<ul>
<li>Driver Node connects to DB-Source, reads Data-1</li>
<li>Data-1 is broken into partitions (RDDs) and distributed to executors nodes for parallel execution.</li>
<li>In each Executor, Transform operation happens locally, that is, no movement.</li>
<li>Action operation, crates shuffle and data has to move. This may cause bottleneck.</li>
<li>Drive Node collects back results.</li>
</ul>
<pre class="mermaid"><code>flowchart TB

subgraph Driver-Node
  Data-1
end

subgraph Driver-Node-
  Data-2
end

subgraph Executor-node-1
  RDD-11 --Transform--&gt; RDD-12 --Action--&gt; RDD-13 --Collect--&gt;Data-2
end

subgraph Executor-node-2
  RDD-21 --Transform--&gt; RDD-22 --Action--&gt; RDD-23 --Collect--&gt;Data-2
end

a1[(Source DB)] --&gt; Data-1
Data-1 --Partition--&gt; RDD-11
Data-1 --Partition--&gt; RDD-21

RDD-12 --Shuffle--&gt; RDD-23
RDD-22 --Shuffle--&gt; RDD-13

Data-2 --&gt; a2[(Destination DB)]
</code></pre>
<h2 id="parallelism">Parallelism</h2>
<ul>
<li>Parallelism is required in all activities, else it becomes bottleneck.</li>
<li>Spark supports parallelism out of the box</li>
<li>Reads<ul>
<li>JDBC - it lets read partitioned column values simultaneously</li>
<li>Kafka - each spark executor reads from subset of Kafka partitions</li>
</ul>
</li>
<li>Processing<ul>
<li>Spark can do transformation, parallelly on different executors.</li>
<li>Spark alo implements <strong>predicate push down</strong> which understands any filter during execution plan, and filter that data at the read itself, that is, it does not even read the data that is to be filtered out.</li>
</ul>
</li>
<li>Writes<ul>
<li>Writing data to sinks is parallel out-of-the-box, each Spark executor can write to JDBC sinks in parallel. Similarly, Spark executors can write to Kafka topics in parallel too.</li>
</ul>
</li>
</ul>
<h2 id="execution-plan">Execution Plan</h2>
<ul>
<li>Spark has Lazy Execution - only an action triggers execution.</li>
<li>Spark Optimizer comes up with a physical plan. This plan optimizes for:<ul>
<li>Reduced I/O</li>
<li>Reduced Shuffling</li>
<li>Reduced Memory Usage</li>
</ul>
</li>
</ul>
<h2 id="spark-core">Spark Core</h2>
<ul>
<li>The foundation of the overall project, it provides basic I/O functionalities, distributed task dispatching, scheduling, and fault recovery.</li>
<li>It supports a wide range of data sources including HDFS, HBase, Cassandra, and S3.</li>
</ul>
<h2 id="spark-streaming">Spark Streaming</h2>
<p>Enables scalable and fault-tolerant stream processing of live data streams. Data can be ingested from many sources like Kafka, Flume, and HDFS, and can be processed using complex algorithms.</p>
<p>In stream processing it is important to maintain the current state. It can help to resume a halted pipeline or restart on failure.</p>
<ul>
<li>Checkpoints<ul>
<li>Saves the job-state to persisted location (HDFS/S3)</li>
<li>recover job state on failure and restart</li>
<li>save metadata and RDDs, like Kafka Offsets, state tracking by Keys, RDDs requiring transformation across multiple batches.</li>
</ul>
</li>
</ul>
<ul>
<li>Watermarking - It lets manage late data arrival in even-time window operations. Spark waits for data to arrive, keeps track of events and ordering</li>
</ul>
<ul>
<li>Keys Tracking - Keys can let track current state, key is modified if state changes.</li>
</ul>
<h2 id="spark-sql-spark-analytics-with-spark-sql">Spark SQL - Spark Analytics with Spark SQL</h2>
<ul>
<li>Spark SQL is part of Spark which lets use SQL interface to interact with data.</li>
<li>It supports batch and streaming.</li>
<li>It lets analyse data in same pipeline.</li>
</ul>
<h2 id="spark-ml-lib-machine-learning-with-spark">Spark ML Lib - Machine Learning with Spark</h2>
<ul>
<li>it make easy to do, feature extraction, transformation, dimensionality reduction.</li>
</ul>
<h2 id="spark-graphx">Spark GraphX</h2>
<ul>
<li>A distributed graph processing framework.</li>
<li>It supports graph computation and provides an API for expressing graph analytics.</li>
</ul>
<h2 id="processing">Processing</h2>
<p><strong>Batch Processing</strong></p>
<ul>
<li>Process data in batches with defined sizes and windows</li>
<li>Source data does not change during processing</li>
<li>Dataset is bounded</li>
<li>High latency (data lags), creating output at the end of processing</li>
<li>Easy to reprocess and get outputs</li>
</ul>
<p><strong>Real Time Processing</strong></p>
<ul>
<li>Process data as they are created at source</li>
<li>Source data may change during processing - it can be added, modified or deleted during processing</li>
<li>Unbounded datasets</li>
<li>Low-latency requirements (data is processed as it is generated)</li>
<li>State Management - Need to keep track of things.</li>
</ul>
<h2 id="spark-installations">Spark Installations</h2>
<ul>
<li>Standalone Mode<ul>
<li>download the spark, install it. This makes <code>bin/pyspark</code> available locally and you can do pyspark things.</li>
<li>simple and lightweight deployment mode for Apache Spark.</li>
<li>you set up spark-home, start master-node and worker-nodes.</li>
<li>They contact on TCP-IP, and then you can use spark.</li>
</ul>
</li>
</ul>
<ul>
<li>Cluster Mode</li>
</ul>
<ul>
<li>Local Mode<ul>
<li>local on single machine. without a cluster, is on a single thread.</li>
<li>eg, just install py package pyspark and you can build a <code>SparkSession</code> and play with it. eg <a href="https://gist.github.com/iYadavVaibhav/2f282e8fc34488ba150542033c9f2c82">https://gist.github.com/iYadavVaibhav/2f282e8fc34488ba150542033c9f2c82</a></li>
</ul>
</li>
</ul>
<h2 id="databricks">Databricks</h2>
<ul>
<li>Lake formation tool. More on <a href="../databricks/">Databricks Notes</a></li>
</ul>
<h2 id="ll-apache-spark-essential-training-big-data-engineering">LL - Apache Spark Essential Training: Big Data Engineering</h2>
<p>Link: <a href="https://linkedin.com/learning/apache-spark-essential-training-big-data-engineering-14259237">Apache Spark Essential Training: Big Data Engineering</a></p>
<p><strong>Learnings</strong></p>
<ul>
<li>Spark jobs are java classes with class-methods doing specific work.</li>
<li>Spark splits data into RDDs based on key, they do single operation in one executor, multi-record-operation by swapping the data in between executors.</li>
<li>Spark can read and write to multiple databases like rdbms, file, kafka etc.</li>
<li>Spark comes up with execution plan by analysing the whole code.</li>
<li>Spark lets maintain the state of job by IDs.</li>
<li>You can build hybrid of real-time and batch job using spark.</li>
<li>The code is java jobs, docker containers for source and sinks.</li>
<li>Spark can consume from Kafka in real time.</li>
<li>Spark can publish a Kafka queue in real time.</li>
<li>Spark can read write to S3, parallelly</li>
<li>Spark can read write to RDBMS, parallelly</li>
</ul>
<p><strong>Project Architecture</strong></p>
<ul>
<li>RDBMS Maria DB<ul>
<li>Runs in docker as MariaDB. Change it to Postgres. <code>image: mariadb</code>, <code>ports: 3306</code></li>
<li>has different data warehouse as databases</li>
<li>Three different databases, represent different purposes<ul>
<li><code>warehouse_stock</code> DB - has different schemas which have data from different regional warehouse data.</li>
<li><code>global_stock</code> DB - has combined worldwide processed stock numbers</li>
<li><code>website_stats</code> DB - has processed stats</li>
</ul>
</li>
<li>Schemas in <code>warehouse_stock</code> DB, represent warehouses<ul>
<li><code>UK-warehouse</code></li>
<li><code>US-warehouse</code></li>
<li><code>IN-warehouse</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Kafka<ul>
<li>Runs in docker. <code>image: 'bitnami/kafka</code>, <code>ports: 9092</code>.</li>
</ul>
</li>
</ul>
<ul>
<li>Spark</li>
</ul>
<ul>
<li>Redis</li>
</ul>
<ul>
<li>Zoo Keeper</li>
</ul>
<ul>
<li>Docker<ul>
<li>runs 4 container for <code>mariadb</code>, <code>kafka</code>, <code>redis</code> and <code>zookeeper</code>.</li>
</ul>
</li>
</ul>
<ul>
<li>Java<ul>
<li>need to be installed on system to run the project. Also needs build tools.</li>
</ul>
</li>
</ul>
<ul>
<li>Ch 3 - batch processing<ul>
<li>An enterprise has warehouse across the globe. Each has local data center.</li>
<li>Stock data for each each item, each day<ul>
<li>Opening Stock - number of items in warehouse</li>
<li>Receipts</li>
<li>Issues</li>
</ul>
</li>
<li>Do Batch Processing to<ul>
<li>Build Global Database with information from each country warehouse.</li>
<li>Gather and upload data to central cloud storage like S3.</li>
<li>Scalable to hundreds of warehouse.</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="mermaid"><code>flowchart LR

db1[(UK RDBMS \n\n warehouse_stock\n.london )]
db2[(US RDBMS \n\n warehouse_stock\n.bostob )]
db3[(India RDBMS \n\n warehouse_stock\n.delhi )]

subgraph sub1[Spark Batch Processing \n Stock Uploader Job]
  sp1[Read MariaDB \n
  SparkSession
  .. .read
  .option: dbtable
  .. .load =&gt; DF


  DF.write
  .. .parquet

  Write to Parquet
  ]
end

db1 --&gt; sp1
db2 --&gt; sp1
db3 --&gt; sp1

dfs1[(Distributed \n File System \n\n raw_data \n Parquet Files)]

sp1 --&gt; dfs1

subgraph sub2[Spark Batch Aggregator Job]
  sp2[
    Read Parquet
    SparkSession.
    .read.parquet: dir
    =&gt; df

    DF =&gt; .sql
    .write: MariaDB JDBC.
    .. .save
    Write to MariaDB
  ]
end

dfs1 --&gt; sp2

db4[(gloabal_stock \n RDBMS)]

sp2 --&gt; db4
</code></pre>
<ul>
<li>Ch 4 - Real time processing<ul>
<li>eCom website like Amazon</li>
<li>Publisher publishes stream of website events like<ul>
<li>visit date</li>
<li>last event - Catalog/FAQ/ShoppingCart/Order</li>
<li>duration</li>
<li>country</li>
</ul>
</li>
<li>Do real time processing to<ul>
<li>Aggregate Five Second summary by last action - each 5s, compute summary and store in RDBMS</li>
<li>Count number of visits by country - Running Counter</li>
<li>Store data of event Abandoned Shopping Cart for further downstream processing - like send email that we have save it for you and it is awaiting checkout.</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="mermaid"><code>flowchart LR

a1&gt;eCom \n Website]
a2[[ Kafka \n Topic \n\n spark.\nstreaming.\nwebsite.\nvisits ]]

a1 --&gt; a2

a2 --&gt; sp0

subgraph sub1[Spark Stream Processing]
  sp0[
    Website \n Analytics Job:

  SparkSession
  .readStream
  .selectExpr
  .load
  =&gt; visitsDf
  ]

  sp1[.filter \n .selectExpr \n .format: Kafka \n .option: Topic \n .writeStream]

  sp2[select \n writeStream \n forEach: Redis]

  sp3[.withColumn \n .withWaterMark \n .groupby..agg \n .writeStream \n .forEach: Maria]

end

sp0 --&gt; sp1
sp0 --&gt; sp2
sp0 --&gt; sp3


b2[(Redis\n\n country-stats)]
b3[(Maria DB\n\nwebsite.\nvisit_stats)]
b1[[Kafka \n Topic\n\nspark.\nstreaming.\ncarts.\nabandoned]]



sp1 --&gt; b1
sp2 --&gt; b2
sp3 --&gt; b3</code></pre>
<ul>
<li>Ch 6 - End to End project - Hybrid Pipeline</li>
</ul>
<pre class="mermaid"><code>flowchart LR

b3[(Maria DB\n\nwebsite.\nvisit_stats)]

b3 --&gt; sp1

subgraph sub1[Spark Batch Job]
  sp1[
    Read MariaDB

    SoarkSession
    .read.option: mariadb
    .load
    =&gt; DF

    DF =&gt; selectExpr \n format: Kafka \n option: Topic \n save

    Write to Topic
  ]
end

sp1 --&gt; a2

a2[[ Kafka \n Topic \n\n spark.\n exercise.\n lastaction. \n long ]]

a2 --&gt; sp2

subgraph sub2[Spark Streaming Job]
  sp2[
    Read Topic

    SparkSession
    .readStream
    .selectExpr.load
    =&gt; visitsDf

    visitsDf =&gt; .selectExpr \n .writeStream \n .forEach: Redis \n .start

    Write to Redis
  ]
end

sp2 --&gt; b2

b2[(Redis\n\n last-action \n -stats)]
</code></pre>
<p><strong>Project Hands On</strong></p>
<ul>
<li>run docker compose to start containers<ul>
<li>Run using <code>docker compose -f spark-docker.yml up</code></li>
<li>It runs following containers<ul>
<li><code>maria db</code> - Just a MySQL RDBMS to store simple tables, exposing 3306</li>
<li><code>redis</code> - For log?, exposing 6379</li>
<li><code>kafka</code> - container running kafka on single node and exposing ports 9092, 29092</li>
<li><code>zookeeper</code>, exposing 2181</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Java Installation<ul>
<li>Install <code>Jdk 17</code> on ubuntu, setup <code>JAVA_HOME</code> to <code>export JAVA_HOME=/usr/bin/java</code>.</li>
<li>Install Java Extension on vscode, it builds all packages using <code>Maven</code>.</li>
</ul>
</li>
</ul>
<ul>
<li>run project setup <code>SetupPrerequisites.java</code><ul>
<li>Build Database Structure, DDL Only<ul>
<li>For each warehouse database<ul>
<li>Check databases, create if not created to avoid dupes</li>
<li>create databases using schema</li>
<li>create table using schema</li>
<li>grand privileges</li>
<li>flush privileges</li>
</ul>
</li>
</ul>
</li>
<li>creates kafka topics<ul>
<li>Create 3 new kafka topics<ul class="task-list">
<li><code>spark.streaming.website.visits</code></li>
<li><code>spark.streaming.carts.abandoned</code></li>
<li><code>spark.exercise.lastaction.long</code></li>
<li>For each topic, check present topic list, if not exists, create it.</li>
<li class="task-list-item"><input type="checkbox"/> read more on what/how to create kafka topics.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Ch 3 Setting local db, run <code>rawStockDataGen.java</code><ul>
<li>It generates data for three warehouse, it puts in three database instances in Maria DB.</li>
<li><code>generateData(warehosue="")</code> function, for each warehouse, it inserts fake data.<ul>
<li>executes insert statement to generate 3 days data.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Ch 3 - Spark Read then Upload - using <code>DailyStockUploaderJob.java</code><ul>
<li>Read Daily Stock from RDBMS to FileStorage</li>
<li>The function <code>uploadStock(String startDate, String endDate, String warehouseId)</code><ul>
<li>Runs query to find min and max id, in between dates in a warehouse. This gives binds.</li>
<li>Create SparkSession<ul>
<li>define host, partition, parallelism, job-name etc.</li>
<li>everything is done using this session object, <code>spark</code></li>
</ul>
</li>
<li>Read from RDBMS using Spark Session Object into Spark-DataFrame<ul>
<li>create a query to read from RDBMS</li>
<li>pass this query to <code>spark.read().option()</code></li>
<li>it returns Spark DataFrame, <code>stockDF</code></li>
</ul>
</li>
<li>Write Spark-DF to File-Storage (normal file/HDFS/S3 logic is same, config change)<ul>
<li><code>stockDF.write()</code> add <code>partitionBy()</code> and <code>parquet(path:)</code></li>
<li>a folder for each date, then folder for each warehouse, this has the parquet file. This is due to partition by stock-date and partition-id.</li>
</ul>
</li>
<li>Close Spark Session<ul>
<li><code>spark.close()</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Ch 3 - Spark Processing - using <code>StockAggregatorJob.java</code><ul>
<li>Aggregate uploaded Stocks Data by reading from file-storage</li>
<li>This is computed on raw parquet files, using spark session, the spark-df is written back to RDBMS Maria-DB using multiple JDBC connectors for parallelism.</li>
<li>In function, <code>aggregateStock(String sourceDir)</code><ul>
<li>Create spark session</li>
<li>Read parquet files at sourceDir to get SparkDF</li>
<li>Load from spark-df to view using <code>stockDF.createOrReplaceTempView("GLOBAL_STOCK");</code> Adds view <code>GLOBAL_STOCK</code> to RDBMS.</li>
<li>Read loaded data using <code>spark.sql("query").show()</code>.<ul>
<li>Group by items, date and aggregate all measure values. You loose, country information.</li>
<li>This is only to print grouped results.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Ch3 - Browse RDBMS data, using <code>GlobalStockDBBrowser.java</code><ul>
<li>lastly, we simply run a java code, to connect to MariaDb and display total count of group-summary table (no spark code here).</li>
<li>alternatively, you can directly run query on RDBMS using various methods.</li>
<li>To use mysql client<ul>
<li>do <code>docker exec -it mariadb bash</code> where 'maria-db' is the container name.</li>
<li>once in container, do <code>mysql -u spark -p</code>, where spark is username and then enter password, which is spark as can be seen in <code>docker-compose.yml</code> file.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Ch 4 - Solution<ul>
<li><code>spark.streaming.websites.visit</code> is publisher that has events data pushed from website whenever user exists the website.</li>
<li>Spark Job 'website analytics job' is consumer for this queue. Now it runs 3 actions on the data received<ul>
<li>Compute 5 sec summary and insert in RDBMS Maria DB, <code>website.visit_stats</code></li>
<li>Running Counter in Redis Socket Set <code>country-stats</code></li>
<li>Filters event having abandoned shopping cart and publishes them to Kafka Queue <code>spark.streaming.carts.abandoned</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>CH 4 - Generate Kafka Stream<ul>
<li>Code generates Kafka events, this is JSON data that tells lastAction, duration, country, datetime.</li>
<li>
<p>Loop 100 times, to generate 100 events, in each loop</p>
<ul>
<li>Using <code>KafkaProducer</code> you can create producer.</li>
<li>Using <code>ProducerRecord</code> you can make a JSON record in a topic, to add to producer.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.kafka.clients.producer.KafkaProducer</span><span class="p">;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.kafka.clients.producer.ProducerRecord</span><span class="p">;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">...</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">for</span><span class="w"> </span><span class="mf">1.</span><span class="p">.</span><span class="mf">.100</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="n">Producer</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">myProducer</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">KafkaProducer</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kafkaProps</span><span class="p">);</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="p">...</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="n">ProducerRecord</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">                                </span><span class="k">new</span><span class="w"> </span><span class="n">ProducerRecord</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">                                        </span><span class="n">topic</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">                                        </span><span class="n">recKey</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">                                        </span><span class="n">value</span><span class="w"> </span><span class="p">);</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">    </span><span class="n">RecordMetadata</span><span class="w"> </span><span class="n">rmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myProducer</span><span class="p">.</span><span class="na">send</span><span class="p">(</span><span class="n">record</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">end</span><span class="w"> </span><span class="n">For</span><span class="p">;</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>Ch 4 - Spark Stream Processing</p>
<ul>
<li>Now that we have kafka events in a topic, we can consume them using spark streaming.</li>
<li>reads a real time website visits stream from kafka<ul>
<li>Updates 5 second summaries in MariaDB</li>
<li>Updates a Country scoreboard in Redis</li>
<li>Updates a Kafka topic, when shopping cart is the last action.</li>
</ul>
</li>
</ul>
<ul>
<li>You create a spark session <code>spark = SparkSession.....getOrCreate();</code></li>
<li>Read into data frame using, <code>df = spark.readStream().format("kafka")......load();</code>. you subscribe to topic here.</li>
<li>Next, use query to read data as required from this broker, into DF</li>
<li>Use DF.writeStream().foreach(ForeachWriter( open.. process.. close.. )) to write. open, process, close - are implemented in <code>RedisWriter.java</code> and <code>MariaDBWriter.java</code>.<ul>
<li>Filter from df to find <code>action: Shopping Cart</code> and then publish this to a kafka topic, <code>spark.streaming.carts.abandoned</code>.</li>
<li>Filter, from df, to filter country info and write it to redis counter.</li>
<li>Use, <strong>WaterMark</strong> feature of spark to group by and aggregate the data every 5 seconds, and write to RDBMS MariaDB.</li>
</ul>
</li>
</ul>
<ul>
<li>Now our Spark-Streaming Pipeline is writing to 3 different places, RDBMS, Redis, Kafka-Topic.</li>
</ul>
<ul>
<li>Browse the written data<ul>
<li>Display the published abandoned shopping cart event using,<code>ShoppingCartTopicBrowser.java</code>. Reads by subscribing to topic using Spark Session.</li>
<li>Display Redis counter data using, <code>CountryStatsBrowser.java</code> every 5 seconds. No spark, connect to Redis and print.</li>
<li>Browse Stats DB using, <code>VisitStatsDBBrowser.java</code> every 5 seconds. No spark, connect to MariaDB and print.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>Ch 6 - Exercise to make Hybrid pipeline having Spark Batch Processing and Stream Processing</p>
<ul>
<li>Spark batch Processing<ul>
<li>Read from MariaDB every night and save to Kafka Topic, use <code>LongLastActionExtractorJob.java</code><ul>
<li>Create session</li>
<li>connect to mariaDB</li>
<li>execute Query</li>
<li>get DF</li>
</ul>
</li>
<li>Write to kafka Topic<ul>
<li>DF, selectExpr</li>
<li>create topic, <code>spark.exercise.lastaction.long</code></li>
<li>save to topic</li>
</ul>
</li>
</ul>
</li>
<li>Spark Streaming Processing<ul>
<li>Subscribe to Topic<ul>
<li>create sparkSession</li>
<li>readStream to read from topic, <code>spark.exercise.lastaction.long</code></li>
<li>load it to DF</li>
</ul>
</li>
<li>Write to redis counter<ul>
<li>DF, selectExpr</li>
<li>writeStream using foreach and process data to write to redis.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Java Classes</strong></p>
<ul>
<li>
<p>Kafka</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.kafka.clients.admin.AdminClient</span><span class="p">;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.kafka.clients.admin.NewTopic</span><span class="p">;</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p><code>Spark</code></p>
<ul>
<li>framework, here is a local JVM code, this is only for demo and testing purpose. Master/node/executors all are running on single JVM code. All you need to do is import the package and create a session with local master and node.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.spark.sql.Dataset</span><span class="p">;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.spark.sql.Row</span><span class="p">;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.spark.sql.SaveMode</span><span class="p">;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.spark.sql.SparkSession</span><span class="p">;</span>
</code></pre></div>
</li>
</ul>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://www.linkedin.com/learning/apache-spark-essential-training">LL - Apache Spark Essential Training</a></li>
</ul>
<!-- taken from 
https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source-file.html -->



<hr />
<div class="md-source-file">
    <small>

        
            <span class="md-icon" title="Last Updated">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
            </span> 
            <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-01-12T02:07:49+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-01-12</span>
        
        

        
            <span class="md-icon" title="Written On">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
            </span>
            <span> Jul 2024 </span>
        
        
    </small>
</div>






                

    
    

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2024 Vaibhav Yadav
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://in.linkedin.com/in/iyadavvaibhav" target="_blank" rel="noopener" title="in.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/iYadavVaibhav/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/iYadavVaibhav/" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.kaggle.com/iyadavvaibhav/kernels" target="_blank" rel="noopener" title="www.kaggle.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://public.tableau.com/profile/iyadavvaibhav" target="_blank" rel="noopener" title="public.tableau.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.654.174v2.203H9.682v.58h1.972V5.16h.696V2.957h1.97v-.58h-1.97V.174h-.348zm6.03 2.262-.002 1.623v1.623h-2.957v.927h2.957v3.188h1.043l.011-1.582.02-1.576 1.465-.02 1.46-.01v-.927h-2.953V2.436h-.522zm-12.407.06v3.19H2.291v.925h2.986v3.19h.985V6.61h3.013v-.925H6.262V2.496H5.77zm6.086 5.27v3.593H8.06v1.188h3.304v3.596h1.28v-3.596h3.309v-1.188h-3.31V7.766h-.637zm9.721 1.55v2.221h-2.012v.811h2.012v2.261h.887v-2.261H24v-.811h-2.029v-2.22h-.422zm-19.111.131v2.174H0v.621h1.973v2.194h.667v-2.194h2v-.62H2.609V9.446h-.318zm15.709 4.516v3.254h-3.016v.927h3.016v3.217h1.072v-3.216h2.986v-.928h-2.986v-3.254h-.533zm-12.463.008v3.246H2.262v.928h2.957v3.189H6.32v-3.189h2.955v-.928H6.32V13.97h-.55zm6.316 4.578.002 1.103v1.1H9.566v.812h1.971v2.262h.928l.012-1.119.017-1.143h1.969v-.812h-2v-2.203h-.465z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.follow", "navigation.top", "search.highlight", "search.suggest", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../assets/javascripts/extra.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>